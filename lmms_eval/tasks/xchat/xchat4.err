/home/seungonk/anaconda3/envs/vllm/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
A new version of the following files was downloaded from https://huggingface.co/allenai/Molmo-7B-D-0924:
- preprocessing_molmo.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:16<01:40, 16.75s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:29<01:13, 14.69s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:41<00:52, 13.22s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:52<00:36, 12.33s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [01:05<00:25, 12.50s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [01:19<00:13, 13.20s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:33<00:00, 13.38s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:33<00:00, 13.36s/it]
  0%|          | 0/50 [00:00<?, ?it/s]/home/seungonk/lmms-eval-mmllm/lmms_eval/tasks/xchat/response_gen.py:127: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.bfloat16):
  2%|▏         | 1/50 [00:09<07:22,  9.03s/it]  4%|▍         | 2/50 [00:18<07:23,  9.24s/it]  6%|▌         | 3/50 [00:28<07:32,  9.63s/it]  8%|▊         | 4/50 [00:37<07:12,  9.41s/it] 10%|█         | 5/50 [00:46<06:55,  9.23s/it] 12%|█▏        | 6/50 [00:59<07:36, 10.38s/it] 14%|█▍        | 7/50 [01:05<06:33,  9.15s/it] 16%|█▌        | 8/50 [01:16<06:46,  9.68s/it] 18%|█▊        | 9/50 [01:28<07:04, 10.36s/it] 20%|██        | 10/50 [01:42<07:39, 11.48s/it] 22%|██▏       | 11/50 [01:46<05:55,  9.13s/it] 24%|██▍       | 12/50 [01:56<06:02,  9.54s/it] 26%|██▌       | 13/50 [02:07<06:09,  9.98s/it] 28%|██▊       | 14/50 [02:18<06:07, 10.20s/it] 30%|███       | 15/50 [02:32<06:42, 11.50s/it] 32%|███▏      | 16/50 [02:37<05:20,  9.44s/it] 34%|███▍      | 17/50 [02:48<05:28,  9.95s/it] 36%|███▌      | 18/50 [03:01<05:42, 10.69s/it] 38%|███▊      | 19/50 [03:06<04:39,  9.02s/it] 40%|████      | 20/50 [03:19<05:10, 10.34s/it] 42%|████▏     | 21/50 [03:35<05:51, 12.12s/it] 44%|████▍     | 22/50 [03:45<05:17, 11.34s/it] 46%|████▌     | 23/50 [04:05<06:13, 13.83s/it] 48%|████▊     | 24/50 [04:20<06:09, 14.23s/it] 50%|█████     | 25/50 [04:29<05:21, 12.87s/it] 52%|█████▏    | 26/50 [04:43<05:15, 13.16s/it] 54%|█████▍    | 27/50 [04:53<04:36, 12.00s/it] 56%|█████▌    | 28/50 [04:59<03:47, 10.35s/it] 58%|█████▊    | 29/50 [05:11<03:45, 10.76s/it] 60%|██████    | 30/50 [05:21<03:31, 10.60s/it] 62%|██████▏   | 31/50 [05:30<03:12, 10.15s/it] 64%|██████▍   | 32/50 [05:36<02:39,  8.86s/it] 66%|██████▌   | 33/50 [05:40<02:08,  7.56s/it] 68%|██████▊   | 34/50 [05:44<01:43,  6.47s/it] 70%|███████   | 35/50 [05:49<01:27,  5.86s/it] 72%|███████▏  | 36/50 [06:02<01:52,  8.06s/it] 74%|███████▍  | 37/50 [06:13<01:56,  8.96s/it] 76%|███████▌  | 38/50 [06:23<01:50,  9.19s/it] 78%|███████▊  | 39/50 [06:35<01:51, 10.10s/it] 80%|████████  | 40/50 [06:47<01:47, 10.71s/it] 82%|████████▏ | 41/50 [06:54<01:25,  9.46s/it] 84%|████████▍ | 42/50 [07:02<01:12,  9.09s/it] 86%|████████▌ | 43/50 [07:12<01:05,  9.31s/it] 88%|████████▊ | 44/50 [07:24<01:01, 10.29s/it] 90%|█████████ | 45/50 [07:30<00:45,  9.02s/it] 92%|█████████▏| 46/50 [07:57<00:56, 14.23s/it] 94%|█████████▍| 47/50 [08:10<00:41, 13.89s/it] 96%|█████████▌| 48/50 [08:20<00:25, 12.74s/it] 98%|█████████▊| 49/50 [08:30<00:12, 12.07s/it]100%|██████████| 50/50 [08:42<00:00, 11.84s/it]100%|██████████| 50/50 [08:42<00:00, 10.45s/it]
/home/seungonk/anaconda3/envs/vllm/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.73it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  5.58it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  6.82it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  7.48it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:00<00:00,  7.53it/s]
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:32<26:21, 32.27s/it]  4%|▍         | 2/50 [00:47<17:58, 22.46s/it]  6%|▌         | 3/50 [01:13<18:35, 23.74s/it]  8%|▊         | 4/50 [01:31<16:29, 21.51s/it] 10%|█         | 5/50 [01:46<14:28, 19.31s/it] 12%|█▏        | 6/50 [02:24<18:44, 25.56s/it] 14%|█▍        | 7/50 [02:52<19:01, 26.55s/it] 16%|█▌        | 8/50 [03:17<18:13, 26.03s/it] 18%|█▊        | 9/50 [03:47<18:32, 27.15s/it] 20%|██        | 10/50 [04:14<18:01, 27.04s/it] 22%|██▏       | 11/50 [04:23<13:58, 21.51s/it] 24%|██▍       | 12/50 [04:54<15:33, 24.57s/it] 26%|██▌       | 13/50 [05:09<13:23, 21.70s/it] 28%|██▊       | 14/50 [05:22<11:26, 19.06s/it] 30%|███       | 15/50 [05:38<10:28, 17.97s/it] 32%|███▏      | 16/50 [05:51<09:23, 16.59s/it] 34%|███▍      | 17/50 [06:21<11:14, 20.44s/it] 36%|███▌      | 18/50 [06:55<13:13, 24.79s/it] 38%|███▊      | 19/50 [07:32<14:39, 28.39s/it] 40%|████      | 20/50 [08:03<14:36, 29.23s/it] 42%|████▏     | 21/50 [08:37<14:45, 30.54s/it] 44%|████▍     | 22/50 [09:01<13:21, 28.64s/it] 46%|████▌     | 23/50 [09:30<12:57, 28.79s/it] 48%|████▊     | 24/50 [09:56<12:04, 27.87s/it] 50%|█████     | 25/50 [10:21<11:18, 27.13s/it] 52%|█████▏    | 26/50 [10:42<10:02, 25.09s/it] 54%|█████▍    | 27/50 [11:09<09:53, 25.82s/it] 56%|█████▌    | 28/50 [11:34<09:21, 25.53s/it] 58%|█████▊    | 29/50 [11:57<08:35, 24.57s/it] 60%|██████    | 30/50 [12:31<09:12, 27.64s/it] 62%|██████▏   | 31/50 [13:05<09:19, 29.43s/it] 64%|██████▍   | 32/50 [13:25<07:58, 26.56s/it] 66%|██████▌   | 33/50 [13:32<05:53, 20.78s/it] 68%|██████▊   | 34/50 [13:37<04:16, 16.06s/it] 70%|███████   | 35/50 [13:39<02:57, 11.81s/it] 72%|███████▏  | 36/50 [14:03<03:36, 15.49s/it] 74%|███████▍  | 37/50 [14:18<03:19, 15.32s/it] 76%|███████▌  | 38/50 [14:41<03:31, 17.64s/it] 78%|███████▊  | 39/50 [15:03<03:29, 19.00s/it] 80%|████████  | 40/50 [15:35<03:47, 22.77s/it] 82%|████████▏ | 41/50 [15:53<03:12, 21.37s/it] 84%|████████▍ | 42/50 [16:01<02:19, 17.49s/it] 86%|████████▌ | 43/50 [16:15<01:54, 16.36s/it] 88%|████████▊ | 44/50 [16:22<01:20, 13.44s/it] 90%|█████████ | 45/50 [16:39<01:12, 14.52s/it] 92%|█████████▏| 46/50 [17:13<01:21, 20.35s/it] 94%|█████████▍| 47/50 [17:33<01:00, 20.27s/it] 96%|█████████▌| 48/50 [17:58<00:43, 21.63s/it] 98%|█████████▊| 49/50 [18:23<00:22, 22.82s/it]100%|██████████| 50/50 [19:14<00:00, 31.26s/it]100%|██████████| 50/50 [19:14<00:00, 23.09s/it]
/home/seungonk/anaconda3/envs/vllm/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:08<00:26,  8.80s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:16<00:16,  8.44s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:26<00:08,  8.71s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:28<00:00,  6.18s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:28<00:00,  7.08s/it]
  0%|          | 0/50 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
  2%|▏         | 1/50 [00:14<11:30, 14.09s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
  4%|▍         | 2/50 [00:23<08:53, 11.11s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
  6%|▌         | 3/50 [00:42<11:40, 14.90s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
  8%|▊         | 4/50 [01:08<14:52, 19.39s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 10%|█         | 5/50 [01:25<13:43, 18.30s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 12%|█▏        | 6/50 [01:44<13:45, 18.76s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 14%|█▍        | 7/50 [02:01<12:55, 18.03s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 16%|█▌        | 8/50 [02:13<11:13, 16.03s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 18%|█▊        | 9/50 [02:30<11:16, 16.51s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 20%|██        | 10/50 [02:47<10:59, 16.49s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 22%|██▏       | 11/50 [02:50<08:12, 12.62s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 24%|██▍       | 12/50 [03:12<09:48, 15.49s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 26%|██▌       | 13/50 [03:27<09:19, 15.12s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 28%|██▊       | 14/50 [03:33<07:30, 12.50s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 30%|███       | 15/50 [03:48<07:40, 13.15s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 32%|███▏      | 16/50 [04:03<07:43, 13.63s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 34%|███▍      | 17/50 [04:16<07:29, 13.61s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 36%|███▌      | 18/50 [04:32<07:40, 14.39s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 38%|███▊      | 19/50 [04:48<07:41, 14.88s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 40%|████      | 20/50 [05:19<09:44, 19.48s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 42%|████▏     | 21/50 [05:33<08:37, 17.83s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 44%|████▍     | 22/50 [05:42<07:10, 15.38s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 46%|████▌     | 23/50 [06:08<08:17, 18.42s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 48%|████▊     | 24/50 [06:28<08:13, 18.97s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 50%|█████     | 25/50 [06:41<07:12, 17.28s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 52%|█████▏    | 26/50 [06:56<06:34, 16.44s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 54%|█████▍    | 27/50 [07:12<06:15, 16.32s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 56%|█████▌    | 28/50 [07:20<05:04, 13.86s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 58%|█████▊    | 29/50 [07:34<04:49, 13.79s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 60%|██████    | 30/50 [07:50<04:53, 14.65s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 62%|██████▏   | 31/50 [08:00<04:12, 13.28s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 64%|██████▍   | 32/50 [08:03<03:03, 10.17s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 66%|██████▌   | 33/50 [08:22<03:36, 12.71s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 68%|██████▊   | 34/50 [08:29<02:57, 11.11s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 70%|███████   | 35/50 [08:31<02:04,  8.29s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 72%|███████▏  | 36/50 [08:39<01:53,  8.10s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 74%|███████▍  | 37/50 [08:52<02:05,  9.64s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 76%|███████▌  | 38/50 [09:08<02:17, 11.43s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 78%|███████▊  | 39/50 [09:21<02:12, 12.05s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 80%|████████  | 40/50 [09:38<02:16, 13.65s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 82%|████████▏ | 41/50 [09:54<02:07, 14.16s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 84%|████████▍ | 42/50 [10:06<01:49, 13.71s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 86%|████████▌ | 43/50 [10:20<01:35, 13.71s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 88%|████████▊ | 44/50 [10:36<01:26, 14.44s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 90%|█████████ | 45/50 [10:50<01:10, 14.08s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 92%|█████████▏| 46/50 [11:11<01:05, 16.40s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 94%|█████████▍| 47/50 [11:32<00:53, 17.68s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 96%|█████████▌| 48/50 [11:49<00:35, 17.50s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
 98%|█████████▊| 49/50 [12:08<00:17, 17.80s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
100%|██████████| 50/50 [12:22<00:00, 16.91s/it]100%|██████████| 50/50 [12:22<00:00, 14.86s/it]
